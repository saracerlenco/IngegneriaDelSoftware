openapi: 3.0.0
info:
  title: "DiscoverTrento API"
  description: "documentazione API per la webapp DiscoverTrento"
  version: "1.0"

#IMPORTANTE! DOBBIAMO SOSTITUIRE I SERVER CON I NOSTRI
servers:
  - url: http://localhost:3000/api/v1
    description: Localhost

components:
  securitySchemes:
    TokenAutenticazione:
      type: "http"
      scheme: "bearer"
      bearerFormat: "JWT"
      description: "Token fornito all'utente all'atto del login necessario per accedere alle risorse riservate"
    

paths:

# session per gestire LOGIN (post) e LOGOUT (delete) degli utenti
  /sessions:
    post:
      summary: "Autenticazione utente tramite credenziali locali"
      description: "L'utente può autenticarsi immettendo email e password"
      tags: 
        - "session"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                email:
                  type: "string"
                  description: "Email utente"
                  example: "Pippo@gmail.com"
                password:
                  type: "string"
                  description: "Password associata all'account"
                  example: "PasswordDiPippo123F"
                ruolo:
                  enum: ["cittadino", "azienda", "operatore_comunale"]
                  description: "Ruolo dell'utente - cittadino, azienda o operatore_comunale"
                  example: "cittadino"
      responses:
        "200":
          description: "L'autenticazione tramite credenziali locali è avvenuta con successo"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  token:
                    type: "string"
                    description: "Token JWT da utilizzare per autenticare richieste future"
                    example: "kjcn3u94eniuqxnie9denind"
                  role:
                    type: "string"
                    description: "Ruolo dell'utente, serve per il reindirizzamento alla dashboard"
                    example: "cittadino"
        "401":
          description: "Credenziali non valide"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Credenziali non valide"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    delete:
      summary: "Logout utente"
      description: "Invalidazione del token di autenticazione dell'utente"
      tags: 
        - "session"
      security:
        - TokenAutenticazione: []  
      responses:
        "204":
          description: "Il logout è avvenuto con successo"
        "401":
          description: "Errore: token non valido o mancante"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Token non valido"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"  

# 3 tipi di utenti con registrazione (post), visualizzazione (get) e modifica (put/patch) dell'area personale
  /cittadini: 
    post:
      summary: "Registrazione utente cittadino"
      description: "Registrazione dell'utente con richiesta di parametri specifici per il cittadino"
      tags: 
        - "cittadino"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                nome:
                  type: "string"
                cognome:
                  type: "string"
                email:
                  type: "string"
                codice_fiscale:
                  type: "string"
                username:
                  type: "string"
                password:
                  type: "string"
              required: ["nome", "cognome", "email", "codice_fiscale", "username", "password"]
      responses:
        "201":
          description: "Registrazione dell'utente cittadino avvenuta con successo"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  id_user:
                    type: "string"
                    description: "ID dell'account appena creato'"
                    example: "12345"
                  messaggio:
                    type: "string"
                    description: "Messaggio di conferma"
                    example: "L'account è stato creato con successo."
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    get:
      summary: "Area personale dell'utente cittadino"
      description: "Permette all'utente cittadino di visualizzare i dati della propria area personale"
      tags: 
        - "cittadino"
      security:
        - TokenAutenticazione: []       
      responses:
        "200":
          description: "Dati personali dell'utente cittadino"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  dati:
                    type: "object"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    put:
      summary: "Modifica dati personali"
      description: "Permette all'utente cittadino di modificare i propri dati dell'area personale"
      tags: 
        - "cittadino"
      security:
        - TokenAutenticazione: []       
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                dati:
                  type: "object"
      responses:
        "200":
          description: "Dati modificati con successo"
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"

  /operatori_comunali: 
    post:
      summary: "Registrazione utente operatore comunale"
      description: "Registrazione dell'utente con richiesta di parametri specifici per l'operatore comunale"
      tags: 
        - "operatore_comunale"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              title: "operatore_comunale"
              description: "Parametri per l'utente operatore comunale"
              properties:
                nome:
                  type: "string"
                cognome:
                  type: "string"
                email:
                  type: "string"
                codice_fiscale:
                  type: "string"
                password:
                  type: "string"
              required: ["nome", "cognome", "email", "codice_fiscale", "password"]
      responses:
        "201":
          description: "Registrazione dell'utente operatore comunale avvenuta con successo"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  id_user:
                    type: "string"
                    description: "ID dell'account appena creato'"
                    example: "12345"
                  messaggio:
                    type: "string"
                    description: "Messaggio di conferma"
                    example: "L'account è stato creato con successo."
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    get:
      summary: "Area personale dell'utente operatore comunale"
      description: "Permette all'utente operatore comunale di visualizzare i dati della propria area personale"
      tags: 
        - "operatore_comunale"
      security:
        - TokenAutenticazione: []      
      responses:
        "200":
          description: "Dati personali dell'utente operatore comunale"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  dati:
                    type: "object"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    put:
      summary: "Modifica dati personali"
      description: "Permette all'utente operatore comunale di modificare i propri dati dell'area personale"
      tags: 
        - "operatore_comunale"
      security:
        - TokenAutenticazione: []       
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                dati:
                  type: "object"
      responses:
        "200":
          description: "Dati modificati con successo"
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"

  /aziende: 
    post: 
      summary: "Registrazione utente azienda"
      description: "Registrazione dell'utente con richiesta di parametri specifici per l'azienda"
      tags: 
        - "azienda"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              title: "azienda"
              description: "Parametri per l'utente azienda"
              properties:
                nome_azienda:
                  type: "string"
                partita_IVA:
                  type: "string"
                email:
                  type: "string"
                password:
                  type: "string"
              required: ["nome_azienda", "partita_IVA", "email", "password"]
      responses:
        "201":
          description: "Registrazione dell'utente azienda avvenuta con successo"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  id_user:
                    type: "string"
                    description: "ID dell'account appena creato'"
                    example: "12345"
                  messaggio:
                    type: "string"
                    description: "Messaggio di conferma"
                    example: "L'account è stato creato con successo."
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    get:
      summary: "Area personale dell'utente azienda"
      description: "Permette all'utente azienda di visualizzare i dati della propria area personale"
      tags: 
        - "azienda"
      security:
        - TokenAutenticazione: []       
      responses:
        "200":
          description: "Dati personali dell'utente operatore comunale"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  dati:
                    type: "object"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    put:
      summary: "Modifica dati personali"
      description: "Permette all'utente azienda di modificare i propri dati dell'area personale"
      tags: 
        - "azienda"
      security:
        - TokenAutenticazione: []       
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                dati:
                  type: "object"
      responses:
        "200":
          description: "Dati modificati con successo"
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"


  #gestione eventi
  /eventi:
    get:
      summary: "Lista degli eventi"
      description: "Restituisce la lista degli eventi, filtrabili per tipologia o data"
      tags: 
        - "evento"
      parameters:
        - name: "tipologia"
          in: "query"
          schema:
            enum: ["sportivo", "culturale", "volontariato"]
          description: "Tipologia dell'evento"
          example: "sportivo"
        - name: "data"
          in: "query"
          schema:
            type: "string"
            format: "date"
          description: "Data dell'evento (formato: YYYY-MM-DD)"
        - name: "luogo"
          in: "query"
          schema:
            type: "string"
          description: "Luogo dell'evento"
          example: "Piazza Duomo"
      responses:
        "200":
          description: "Lista degli eventi"
          content:
            application/json:
              schema:
                type: "array"
                items:
                  type: "object"
                  properties:
                    id_evento:
                      type: "string"
                    nome_evento:
                      type: "string"
                    data:
                      type: "string"
                      format: "date"
                    luogo:
                      type: "string"
                    tipologia:
                      enum: ["sportivo", "culturale", "volontariato"]
                    descrizione:
                      type: "string"
                    punti:
                      type: "integer"
                    creatore:
                      type: "string"
                      description: "id del cittadino o dell'operatore comunale che ha creato l'evento"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    post:
      summary: "Proposta evento"
      description: "Consente a cittadino e operatore comunale di proporre un evento, specificandone i dettagli, luogo e data"
      tags: 
        - "evento"
      security:
        - TokenAutenticazione: []       
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                nome_evento:
                  type: "string"
                data:
                  type: "string"
                  format: "date"
                luogo:
                  type: "string"
                tipologia:
                  enum: ["sportivo", "culturale", "volontariato"]
                descrizione:
                  type: "string"
                punti:
                  type: "integer"
                  description: "Considerato solo nel caso in cui sia l'utente operatore_comunale a creare l'evento"
              required: ["nome_evento", "data", "luogo", "tipologia"]
      responses:
        "201":
          description: "La creazione dell'evento è avvenuta con successo"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  id_evento:
                    type: "string"
                    description: "ID dell'evento creato"
                    example: "12345"
                  messaggio:
                    type: "string"
                    description: "Messaggio di conferma"
                    example: "L'evento è stato creato con successo."
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "403":   # se l'utente azienda prova a proporre un evento
          description: "Forbidden: la tipologia di utente non permette la proposta di eventi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Azione non permessa"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"

  /eventi/:id_evento:
    put: 
      summary: "Assegnazione punti ad un evento"
      description: "Permette all'utente operatore_comunale di assegnare un punteggio ad un evento"
      tags:
        - "evento"
      security:
        - TokenAutenticazione: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                punti:
                  type: "integer"
                  description: "Punteggio assegnato al coupon"
              required: [ "punti"]
      responses:
        "200":
          description: "Il punteggio è stato assegnato all'evento dal comune con successo"
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "403":  
          description: "Forbidden: la tipologia di utente non permette la proposta di coupon"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Azione non permessa"
        "404":
          description: "Evento non trovato"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Evento non trovato"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"


  /partecipazioni/:id_evento:
    parameters:
      - name: "id_evento"
        in: "path"
        schema:
          type: "string"
        required: true
    post:
      summary: "Partecipazione ad un evento"
      description: "Permette all'utente cittadino che ha effettuato il login di segnare la propria partecipazione ad un evento, visualizzandolo poi aggiunto alla propria to-attend-list"
      tags: 
        - "partecipazione"
      security:
        - TokenAutenticazione: []
      responses:
        "201":
          description: "Partecipazione all'evento segnata con successo"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  id_partecipazione:
                    type: "string"
                    description: "ID della partecipazione creata"
                    example: "12345"
                  messaggio:
                    type: "string"
                    description: "Messaggio di conferma"
                    example: "La partecipazione è stata registrata con successo."
                  id_evento:
                    type: "string"
                    description: "ID dell'evento a cui partecipi"
                    example: "67890"
        "403":  
          description: "Forbidden: la tipologia di utente non permette la proposta di coupon"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Azione non permessa"
        "404":
          description: "Evento non trovato"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Evento non trovato"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    get:
      summary: "Lista partecipazioni"
      description: "Restituisce una lista di partecipazione dei cittadini agli eventi"
      tags: 
        - "partecipazione"
      security:
        - TokenAutenticazione: []       
      responses:
        "200":
          description: "Lista partecipazioni dei cittadini agli eventi"
          content:
            application/json:
              schema:
                type: "array"
                items:
                  type: "object"
                  properties:
                    id_evento:
                      type: "string"
                    id_cittadino:
                      type: "string"
        "404":
          description: "Evento non trovato"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Evento non trovato"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    delete:
      summary: "Cancellazione partecipazione"
      description: "Permette di annullare la partecipazione di un cittadino ad un evento"
      tags: 
        - "partecipazione"
      security:
        - TokenAutenticazione: []       
      responses:
        "204":
          description: "La partecipazione è stata annullata con successo"
        "404":
          description: "Errore: partecipazione non trovata"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Partecipazione inesistente"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"


  /sponsorizzazioni/:id_evento:
    parameters:
      - name: "id_evento"
        in: "path"
        schema:
          type: "string"
        required: true
    post:
      summary: "Sponsorizzazione di un evento"
      description: "Permette all'utente azienda che ha effettuato il login di segnare la propria sponsorizzazione ad un evento, visualizzandolo poi aggiunto alla propria to-sponsor-list"
      tags: 
        - "sponsorizzazione"
      security:
        - TokenAutenticazione: []       
      responses:
        "201":
          description: "Sponsorizzazione dell'evento assegnata con successo"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  id_partecipazione:
                    type: "string"
                    description: "ID della sponsorizzazione creata"
                    example: "12345"
                  messaggio:
                    type: "string"
                    description: "Messaggio di conferma"
                    example: "La sponsorizzazione è stata registrata con successo."
                  id_evento:
                    type: "string"
                    description: "ID dell'evento sponsorizzato"
                    example: "67890"
        "404":
          description: "Evento non trovato"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Evento non trovato"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    get:
      summary: "Lista sponsorizzazioni"
      description: "Restituisce una lista di eventi sponsorizzati dalle aziende"
      tags: 
        - "sponsorizzazione"
      security:
        - TokenAutenticazione: []       
      responses:
        "200":
          description: "Lista eventi sponsorizzati dalle aziende"
          content:
            application/json:
              schema:
                type: "array"
                items:
                  type: "object"
                  properties:
                    id_evento:
                      type: "string"
                    id_azienda:
                      type: "string"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    delete:
      summary: "Cancellazione sponsorizzazione"
      description: "Permette all'azienda di annullare la sponsorizzazione di un evento"
      tags: 
        - "sponsorizzazione"
      security:
        - TokenAutenticazione: []       
      responses:
        "204":
          description: "La sponsorizzazione è stata annullata con successo"
        "404":
          description: "Errore: sponsorizzazione non trovata"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Sponsorizzazione inesistente"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"


  #gestione feedback 
  /feedbacks/:id_evento:
    parameters:
    - name: "id_evento"
      in: "path"
      schema:
        type: "string"
      required: true
    post:
      summary: "Lascia feedback evento"
      description: "Permette ai cittadini che hanno partecipato ad un evento di lasciare feedback e commenti allo stesso"
      tags: 
        - "feedback"
      security:
        - TokenAutenticazione: []       
      parameters:
        - name: "id_evento"
          in: "path"
          required: true
          schema:
            type: "string"
          description: "ID dell'evento"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                commento:
                  type: "string"
                  example: "Evento ben organizzato"
                rating:
                  type: "integer"
                  example: 5
              required: ["rating"]
      responses:
        "201":
          description: "Feedback registrato"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  id_feedback: 
                    type: "string"
                    description: "ID del feedback appena creato"
                    example: "12345"
                  message:
                    type: "string"
                    example: "Feedback registrato"
                  id_evento:
                    type: "string"
                    description: "ID dell'evento a cui è relativo il feedback"
                    example: "67890"
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi!"
    get:
      summary: "Recensioni eventi"
      description: "Restituisce gli eventi con i relativi feedback (rating + eventuale commento)"
      tags: 
        - "feedback"
      security:
        - TokenAutenticazione: []       
      responses:
        "200":
          description: "Recupero con successo"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  media_rating:
                    type: "number"
                    example: 4.5
                  comments:
                    type: "array"
                    items:
                      type: "object"
                      properties:
                        username:
                          type: "string"
                        commento:
                          type: "string"
                          example: "Evento ben organizzato"
                        rating:
                          type: "integer"
                          example: 5
        "404":
          description: "Evento non trovato"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Evento non trovato"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"

#gestione coupon
  /coupons:
    post:
      summary: "Offri coupon"
      description: "Permette alle aziende di proporre coupon e sconti - poi dovranno essere approvati e convertiti in punti dal comune"
      tags: 
        - "coupon"
      security:
        - TokenAutenticazione: [] 
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                descrizione_coupon:
                  type: "string"
                sconto_offerto:
                  type: "number"
                  format: "float"
              required: ["descrizione_coupon", "sconto_offerto"]
      responses:
        "201":
          description: "Proposta di coupon al comune avvenuta con successo"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  id_proposta_coupon: 
                    type: "string"
                    description: "ID della proposta coupon appena creata"
                    example: "12345"
                  message:
                    type: "string"
                    example: "Proposta registrata"
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "403":   # se un utente che non è un'azienda prova a proporre un coupon
          description: "Forbidden: la tipologia di utente non permette la proposta di coupon"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Azione non permessa"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    get:
      summary: "Lista dei coupon"
      description: "Restituisce la lista dei coupon offerti dalle aziende"
      tags: 
        - "coupon"
      security:
        - TokenAutenticazione: []      
      responses:
        "200":
          description: "Lista dei coupon"
          content:
            application/json:
              schema:
                type: "array"
                items:
                  type: "object"
                  properties:
                    id_azienda:
                      type: "string"
                    descrizione_coupon:
                      type: "string"
                    sconto_offerto:
                      type: "number"
                    approvato:
                      type: "boolean"
                    punti:
                      type: "integer"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
  /coupons/:id_coupon:  
    parameters:
    - name: "id_coupon"
      in: "path"
      required: true
      schema:
        type: "string"
      description: "ID del coupon"
    put: 
      summary: "Approva coupon e associa punti"
      description: "Permette all'operatore comunale di approvare i coupon e associargli un punteggio"
      tags: 
        - "coupon"
      security:
        - TokenAutenticazione: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                approvato:
                  type: "boolean"
                punti:
                  type: "integer"
                  description: "Punteggio assegnato al coupon"
              required: ["approvato", "punti"]
      responses:
        "200":
          description: "Il coupon è stato approvato dal comune con successo e gli è stato assegnato un punteggio"
        "400":
          description: "Richiesta non valida: dati mancanti o non validi"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Richiesta non valida"
        "403":  
          description: "Forbidden: la tipologia di utente non permette la proposta di coupon"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Azione non permessa"
        "404":
          description: "Coupon non trovato"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Coupon non trovato"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
    delete:
      summary: "Cancellazione coupon"
      description: "Permette di annullare un coupon"
      tags: 
        - "coupon"
      security:
        - TokenAutenticazione: []       
      responses:
        "204":
          description: "Il coupon è stato annullato con successo"
        "404":
          description: "Errore: coupon non trovato"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Coupon inesistente"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
                  
  /shop:
    get:
      summary: "Lista dei coupon del cittadino"
      description: "Restituisce la lista dei coupon offerti dalle aziende che il cittadino ha ottenuto convertendo i punti guadagnati"
      tags: 
        - "shop"
      security:
        - TokenAutenticazione: []      
      responses:
        "200":
          description: "Lista dei coupon"
          content:
            application/json:
              schema:
                type: "array"
                items:
                  type: "object"
                  properties:
                    id_coupon:
                      type: "string"
        "403":  
          description: "Forbidden: la tipologia di utente non permette la proposta di coupon"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Azione non permessa"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi"
  /shop/id_coupon:
    post:
      summary: "Aggiungi coupon allo shop del cittadino"
      description: "Permette ai cittadini di convertire i propri punti in coupon"
      tags: 
        - "shop"
      security:
        - TokenAutenticazione: []       
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: "object"
              properties:
                id_coupon:
                  type: "string"
                  example: "1234"
      responses:
        "201":
          description: "Coupon aggiunto allo shop"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  id_coupon: 
                    type: "string"
                    description: "ID del coupon appena aggiunto allo shop"
                    example: "12345"
        "403":  
          description: "Forbidden: la tipologia di utente non permette la proposta di coupon"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Azione non permessa"
        "404":
          description: "Errore: coupon non trovato"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Coupon inesistente"
        "500":
          description: "Errore del server"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  error:
                    type: "string"
                    example: "Errore del server, riprova più tardi!"
