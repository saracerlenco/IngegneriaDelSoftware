<!DOCTYPE HTML>
<html>
<head>
	<title>DiscoverTrento</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="../assets/css/main.css" />
    <link rel="shortcut icon" href="../images/logo.ico" />
    <link rel="stylesheet" href="../assets/css/calendar.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
	<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
    <script src="//unpkg.com/jwt-js-decode@1.9.0/dist/jwt-js-decode.pkg.min.js"></script><!--per visualizzare il token-->
	
</head>
<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Header -->
		<header id="header">
			<h1>Discover-Trento</h1>
		</header>

		<!-- Nav -->
		<nav id="nav">
			<ul class="links">
				<li><a href="../index.html">Mappa</a></li>
				<li><a href="eventi.html">Eventi</a></li>
				<li><a href="operatore_comunale_area_personale.html">Area personale</a></li>
                <li class="active"><a href="proponi _evento.html">proponi evento</a></li>
			</ul>
		</nav>

		<!-- Main -->
		<div id="main">

			<!-- Selezione -->
			<section class="post">
				<h2>Riempi i campi e proponi il tuo evento!</h2>
                <script>
                    function verifica_dati(button)
                    {
                            const inputs = document.querySelectorAll('input');
                            const all_filled = Array.from(inputs).every(input => input.value.trim() !== '');
                            if (!all_filled) {
                                alert("Tutti i campi sono obbligatori");
                                return; // Stop further execution
                            }
                            else{
                                try {
                                    const nome = document.querySelector('#nome').value;
                                    const data_inizio = document.querySelector('#date-picker').value;
                                    const data_fine = document.querySelector('#date-picker').value;
                                    const location = document.querySelector('#location').value;
                                    const categoria = document.querySelector('#categoria').value;
                                    const descrizione = document.querySelector('#descrizione').value;

                                    // Crea un oggetto evento
                                    const evento = {
                                        nome: nome,
                                        data_inizio: data_inizio,
                                        data_fine: data_fine,
                                        location: location,
                                        categoria: categoria,
                                        descrizione: descrizione
                                    };

                                    // Salva l'evento nel localStorage
                                    localStorage.setItem('eventoProposto', JSON.stringify(evento));
                                } catch (error) {
                                    console.error("Errore durante la proposta dell'evento:", error);
                                }
                                alert("Evento proposto con successo");
                                window.location.href = 'eventi.html';            
                            }                           
                        }                        
                        
                    const now = new Date();
                    // Formatta la data in modo compatibile con datetime-local
                    const formattedNow = now.toISOString().slice(0, 16);
                    // Imposta il valore minimo dell'input
                    document.querySelector('#datetime').setAttribute('min', formattedNow);
                </script>
                <form method="post" action="#">
                    <div class="fields">
                        <div class="field">
                            <label>Nome:</label>
                            <input type="text" name="nome_evento" id="nome" />
                        </div>
                        <div class="field" >
                            <div class="col-6 col-12-small">
                                <label>Inizio evento:</label>
                                <!--<input type="text" id="data_inizio" class="date-picker" placeholder="Clicca per scegliere una data">-->
                                <input type="text" id="date-picker" name="data_inizio" class="date-picker" placeholder="Clicca per scegliere una data"> 
                                <label>Data fine:</label>
                                <!--<input type="text" id="data_fine" name="data_fine" class="date-picker" placeholder="Clicca per scegliere una data">-->
                                <input type="text" id="date-picker" name="data_fine" class="date-picker" placeholder="Clicca per scegliere una data">
                            </div>
                        </div>
                        <div class="field">
                            <label>Location:</label>
                            <input type="text" name="location" id="location" />
                        </div>
                        <div class="field">
                            <label>Categoria:</label>
                            <input type="text" name="categoria" id="categoria" />
                        </div>
                        <div class="field">
                            <label>Descrizione:</label>
                            <input type="text" name="descrizione" id="descrizione" />
                        </div>
                    </div>
                     <div class="col-6 col-12-small">
                        <ul class="actions stacked">
                            <li><a onclick="verifica_dati(this)" class="button">Proponi evento</a></li>
                        </ul>
                    </div>
                </form>
			</section>

		</div>

        <script>
            const { decode } = jwtJsDecode;// per decodificare il token JWT
            const token = localStorage.getItem("token"); 
            if(token && decode(token)){
                document.getElementById("log").innerText = "Logout";
                document.getElementById("log").href = "javascript:void(0);"; 
                document.getElementById("log").onclick = ()=>{
                    localStorage.removeItem("token");
                    alert(`Logout effettuato con successo`);
                    window.location.href="../index.html"; // Reindirizza alla pagina principale
                }
            }
        </script>

		<!-- Copyright -->
		<div id="copyright">
			<ul><li>&copy; DiscoverTrento</li><li>Design: <a href="https://html5up.net">HTML5	

		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrollex.min.js"></script>
			<script src="../assets/js/jquery.scrolly.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>
           <!--  <script src="../assets/js/calendar.js"></script> -->
			<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
            

	</body>
</html>